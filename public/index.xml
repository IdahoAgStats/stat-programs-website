<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Idaho Ag Stats</title>
    <link>/</link>
      <atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    <description>Idaho Ag Stats</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Thu, 15 Apr 2021 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_2.png</url>
      <title>Idaho Ag Stats</title>
      <link>/</link>
    </image>
    
    <item>
      <title>Python basics</title>
      <link>/tutorials/example/python/</link>
      <pubDate>Fri, 01 Jan 2021 00:00:00 +0000</pubDate>
      <guid>/tutorials/example/python/</guid>
      <description>&lt;p&gt;Build a foundation in Python.&lt;/p&gt;
&lt;p&gt;
  &lt;i class=&#34;fas fa-clock  pr-1 fa-fw&#34;&gt;&lt;/i&gt; 1-2 hours per week, for 8 weeks&lt;/p&gt;
&lt;h2 id=&#34;learn&#34;&gt;Learn&lt;/h2&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/rfscVS0vtbw&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;h2 id=&#34;quiz&#34;&gt;Quiz&lt;/h2&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-2&#34;&gt;
  &lt;summary&gt;What is the difference between lists and tuples?&lt;/summary&gt;
  &lt;p&gt;&lt;p&gt;Lists&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lists are mutable - they can be changed&lt;/li&gt;
&lt;li&gt;Slower than tuples&lt;/li&gt;
&lt;li&gt;Syntax: &lt;code&gt;a_list = [1, 2.0, &#39;Hello world&#39;]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tuples&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tuples are immutable - they can&amp;rsquo;t be changed&lt;/li&gt;
&lt;li&gt;Tuples are faster than lists&lt;/li&gt;
&lt;li&gt;Syntax: &lt;code&gt;a_tuple = (1, 2.0, &#39;Hello world&#39;)&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/p&gt;
&lt;/details&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-3&#34;&gt;
  &lt;summary&gt;Is Python case-sensitive?&lt;/summary&gt;
  &lt;p&gt;Yes&lt;/p&gt;
&lt;/details&gt;</description>
    </item>
    
    <item>
      <title>Visualization</title>
      <link>/tutorials/example/visualization/</link>
      <pubDate>Fri, 01 Jan 2021 00:00:00 +0000</pubDate>
      <guid>/tutorials/example/visualization/</guid>
      <description>&lt;p&gt;Learn how to visualize data with Plotly.&lt;/p&gt;
&lt;p&gt;
  &lt;i class=&#34;fas fa-clock  pr-1 fa-fw&#34;&gt;&lt;/i&gt; 1-2 hours per week, for 8 weeks&lt;/p&gt;
&lt;h2 id=&#34;learn&#34;&gt;Learn&lt;/h2&gt;

&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://www.youtube.com/embed/hSPmj7mK6ng&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;

&lt;h2 id=&#34;quiz&#34;&gt;Quiz&lt;/h2&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-2&#34;&gt;
  &lt;summary&gt;When is a heatmap useful?&lt;/summary&gt;
  &lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&lt;/p&gt;
&lt;/details&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-3&#34;&gt;
  &lt;summary&gt;Write Plotly code to render a bar chart&lt;/summary&gt;
  &lt;p&gt;&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;import plotly.express as px
data_canada = px.data.gapminder().query(&amp;quot;country == &#39;Canada&#39;&amp;quot;)
fig = px.bar(data_canada, x=&#39;year&#39;, y=&#39;pop&#39;)
fig.show()
&lt;/code&gt;&lt;/pre&gt;
&lt;/p&gt;
&lt;/details&gt;</description>
    </item>
    
    <item>
      <title>Statistics</title>
      <link>/tutorials/example/stats/</link>
      <pubDate>Fri, 01 Jan 2021 00:00:00 +0000</pubDate>
      <guid>/tutorials/example/stats/</guid>
      <description>&lt;p&gt;Introduction to statistics for data science.&lt;/p&gt;
&lt;p&gt;
  &lt;i class=&#34;fas fa-clock  pr-1 fa-fw&#34;&gt;&lt;/i&gt; 1-2 hours per week, for 8 weeks&lt;/p&gt;
&lt;h2 id=&#34;learn&#34;&gt;Learn&lt;/h2&gt;
&lt;p&gt;The general form of the &lt;strong&gt;normal&lt;/strong&gt; probability density function is:&lt;/p&gt;
&lt;p&gt;$$
f(x) = \frac{1}{\sigma \sqrt{2\pi} } e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}
$$&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    The parameter $\mu$ is the mean or expectation of the distribution.
$\sigma$ is its standard deviation.
The variance of the distribution is $\sigma^{2}$.
  &lt;/div&gt;
&lt;/div&gt;

&lt;h2 id=&#34;quiz&#34;&gt;Quiz&lt;/h2&gt;
&lt;details class=&#34;spoiler &#34;  id=&#34;spoiler-2&#34;&gt;
  &lt;summary&gt;What is the parameter $\mu$?&lt;/summary&gt;
  &lt;p&gt;The parameter $\mu$ is the mean or expectation of the distribution.&lt;/p&gt;
&lt;/details&gt;</description>
    </item>
    
    <item>
      <title>Getting R Set Up</title>
      <link>/post/getting-r-setup/</link>
      <pubDate>Thu, 15 Apr 2021 00:00:00 +0000</pubDate>
      <guid>/post/getting-r-setup/</guid>
      <description>&lt;h4 id=&#34;install-r&#34;&gt;Install R:&lt;/h4&gt;
&lt;p&gt;You can download R &lt;a href=&#34;https://cloud.r-project.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;here&lt;/a&gt;. Get the correction R distribution for your operating system. Once downloaded, click on downloaded file, and follow the installation instructions.&lt;/p&gt;
&lt;p&gt;Note that R is updated several times per year. If you installation is a year older or more, consider updating your version of R to the latest version.&lt;/p&gt;
&lt;h4 id=&#34;install-rstudio&#34;&gt;Install RStudio&lt;/h4&gt;
&lt;p&gt;Rstudio is not R, rather, it is a user interface for accessing R. It is complicated with many features for developers. Despite that, it is still a very helpful R user interface for users of all abilities. It can downloaded &lt;a href=&#34;https://www.rstudio.com/products/rstudio/download/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;here&lt;/a&gt;. For most users, the free version of &amp;ldquo;RStudio Desktop&amp;rdquo; should be chosen. Once downloaded, click on downloaded file, and follow the installation instructions.&lt;/p&gt;
&lt;h4 id=&#34;install-rtools-optional&#34;&gt;Install Rtools (optional)&lt;/h4&gt;
&lt;p&gt;Only Windows users need to consider this step. This app is for compiling R packages with C, C++ and Fortran code. It is a separate piece of software that has to be downloaded and installed (it is not an R package). Rtools is not needed by all users and if you don&amp;rsquo;t know if you need this, it is absolutely fine to skip this step.  If you do think you need this, You can find it &lt;a href=&#34;https://cran.r-project.org/bin/windows/Rtools/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;here&lt;/a&gt;. Download and install.&lt;/p&gt;
&lt;h4 id=&#34;rstudio-setup-optional&#34;&gt;RStudio Setup (optional)&lt;/h4&gt;
&lt;p&gt;This is an optional step, but it is highly recommended. This step will prevent RStudio from saving all of your objects in a session to &lt;code&gt;.Rdata&lt;/code&gt; file that is then automatically loaded whenever you open R.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;install.packages(&amp;quot;usethis&amp;quot;); library(usethis)
usethis::use_blank_slate()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Why is automatic loading of an &lt;code&gt;.Rdata&lt;/code&gt; file not recommended? Because it makes your work less reproducible. You may have created test objects that will unexpectedly interfere with downstream operations or analysis. You may have changed the original data source, but an older version is saved in the &lt;code&gt;.Rdata&lt;/code&gt; file. More explanation is given by &lt;a href=&#34;https://usethis.r-lib.org/reference/use_blank_slate.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RStudio&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;IF you are used to opening R and seeing all of your previous objects automatically loaded into the objects pane, this will be an adjustment. The solution is to save your processes into &lt;code&gt;.R&lt;/code&gt; scripts that capture all information from packages loaded, file import, all data manipulations and other operations important. If these steps are slow and there is a need to access intermediate objects, these can be saved in tabular formats readable by many applications (e.g. .txt or .csv) or saved as a specific R object (see &lt;code&gt;saveRDS()&lt;/code&gt; in the R help files) and reloaded in another session.&lt;/p&gt;
&lt;h4 id=&#34;set-up-version-control-optional&#34;&gt;Set up version control (optional)&lt;/h4&gt;
&lt;p&gt;If you use Git or SVN, you can perform Git operations directions from RStudio and interact with remote repositories. If you don&amp;rsquo;t use version control, this step can be skipped. If you do use version control, the command line or other third-party software (e.g. Gitkraken) are fine to use instead or in addition to RStudio&amp;rsquo;s interface. The implementation of git in R is very minimal and can support only a limited number of actions, so you are likely to need to use other software for complicated git actions. It is useful for file additions (equivalent to &lt;code&gt;git add&lt;/code&gt;), commits, pushes and pulls.&lt;/p&gt;
&lt;p&gt;You can set up Git by going to &amp;ldquo;Tools&amp;rdquo; &amp;ndash;&amp;gt; &amp;ldquo;Global Options &amp;ndash;&amp;gt; &amp;ldquo;Git/SVN&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;This is not the right space to discuss how to use Git as an R user, but Jenny Bryan wrote a very good &lt;a href=&#34;https://happygitwithr.com/index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tutorial&lt;/a&gt; covering this subject.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Quick Tricks and Tips for Reproducible Research in R</title>
      <link>/post/reproducible-r/</link>
      <pubDate>Thu, 15 Apr 2021 00:00:00 +0000</pubDate>
      <guid>/post/reproducible-r/</guid>
      <description>&lt;h3 id=&#34;make-sure-your-rstudio-session-is-not-saving-rdata-automatically&#34;&gt;Make sure your Rstudio session is not saving &lt;code&gt;.rdata&lt;/code&gt; automatically:&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Note: this step requires the&lt;/em&gt; &lt;code&gt;usethis&lt;/code&gt; &lt;em&gt;package; please install if you do not already have it installed.&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;usethis::use_blank_slate()
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;save-all-code-you-run-in-an-r-or-rmd-file&#34;&gt;Save all code you run in an &lt;code&gt;.R&lt;/code&gt; or &lt;code&gt;.Rmd&lt;/code&gt; file&lt;/h3&gt;
&lt;p&gt;This is your source code. It&amp;rsquo;s as real and as important as your input data. This file should capture a set of actions that can be repeated by another person (e.g. your PI, yourself in the future) including packages loaded, files imported, all data manipulations and the outputs from these actions (e.g. visualisations, analytical outcomes). The idea is to capture your thought process so this can be repeated in full. In most analyses, it is extremely likely* you will revisit a project and need to repeat what has already been done.! Keeping a record of actions will save loads and loads of time because you will not have to expend an effort to recall exactly what you did in previous sessions.&lt;/p&gt;
&lt;p&gt;*This is &lt;em&gt;almost&lt;/em&gt; guaranteed to happen!&lt;/p&gt;
&lt;h3 id=&#34;regularly-restart-your-r-session&#34;&gt;Regularly restart your R session&lt;/h3&gt;
&lt;p&gt;Yes, that means wiping all the loaded packaged and objects from the session (if you followed Step 1 in these instructions), but the upside is that your analysis are reproducible. This means future you can repeat those analyses and get the same results back you did earlier!&lt;/p&gt;
&lt;p&gt;You can restart R by manually closing and opening RStudio. You can also restart the R session with RStudio by navigating to the menu item &amp;ldquo;Session&amp;rdquo; and and selecting &amp;ldquo;Restart R&amp;rdquo;.&lt;/p&gt;
&lt;h3 id=&#34;use-r-projects&#34;&gt;Use R projects&lt;/h3&gt;
&lt;p&gt;This is optional, but it will make your life easier. Whenever you start a new analytical endeavor in R, create an R project by navigating to &amp;ldquo;File&amp;rdquo; &amp;ndash;&amp;gt; &amp;ldquo;New Project&amp;rdquo; in RStudio. There&amp;rsquo;s many options here for setting the directory to place the .rpoj, type of project (e.g. R package, Shiny app or blank), and initializing a git repo. The simplest option is to choose &amp;ldquo;New Project&amp;rdquo; (no special type) and put it in a dedicated directory. The main advantage of projects is that by opening an .Rproj file, the working directory is automatically set to that directory. If you are using a cloud solution for working across different computers or working with collaborators, this will make things easier because you can use relative paths for importing data and outputting files. There would be no more need for this at the top of your script:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;setwd(&amp;quot;specific/path/to/my/computer&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Additionally, for setting up gitbooks through &lt;code&gt;bookdown&lt;/code&gt;, R packages, Shiny apps, and other complicated R endeavors, the automated set-up through Rprojects can be immensely helpful.&lt;/p&gt;
&lt;p&gt;This is sometimes referred to as &amp;ldquo;project-oriented workflow.&amp;rdquo; I prefer to have a consistent directory structure like so:&lt;/p&gt;
&lt;p&gt;top-level-directory
│   README.md
│
└───data
│      file011.txt
│      file012.txt
│&lt;br&gt;
└───scripts
│       eda.R
│       report.Rmd
│&lt;br&gt;
└───outputs
│       plot1.png
│       table1.csv
│&lt;br&gt;
└───extra
some_paper.pdf
email.pdf&lt;/p&gt;
&lt;p&gt;I put all raw data needed for analysis into the &amp;lsquo;data&amp;rsquo; directory, any and all programming scripts in the &amp;ldquo;scripts&amp;rdquo; directory, all outputs (plots, tables, intermediate data object) in the &amp;lsquo;outputs&amp;rsquo; directory and everything else ends up &amp;lsquo;extra&amp;rsquo;. Naturally, there are many different directory structures to use and this is just one example. Find something that works best for your needs!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Use the &lt;code&gt;here&lt;/code&gt; package.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This is also optional. It works like Rprojects for setting the working directory. However, for an Rproject to work, you have to open the .Rproj file in RStudio. What if you or your collaborators prefer to open R files directly and start using those? Here will look for the next directory level which there is a .Rproj file and set the working directory there.&lt;/p&gt;
&lt;p&gt;If you want to import a file, &amp;ldquo;datafile.csv&amp;rdquo; that located in the data directory. Your .R script is actually located in the &amp;lsquo;scripts&amp;rsquo; directory. Normally, if you try to read that in, you need to specify the full path to &amp;ldquo;mydata.csv&amp;rdquo; or set the working directory and use a relative path. Again, these paths will not work if you switch computers or your collaborators are running these scripts on their own systems. This system gets even more complicated when working iwth an .Rmd file. Here&amp;rsquo;s an alternative approach that works the same across files and systems:&lt;/p&gt;
&lt;p&gt;First, make sure you have .Rproj file to define the top-level directory.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;library(here)
mydata &amp;lt;- read.csv(here(&amp;quot;data&amp;quot;, &amp;quot;datafile.csv&amp;quot;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This code will construct this path: &amp;ldquo;data/datafile.csv&amp;rdquo; and execute that command under the assumption that wherever that .rproj is located (going up one directory at a time until it finds it) is where the working directory is set. Putting &lt;code&gt;library(here)&lt;/code&gt; into every .R or .Rmd file in a project will resolve these issues.&lt;/p&gt;
&lt;h3 id=&#34;use-r-environments&#34;&gt;Use R environments.&lt;/h3&gt;
&lt;p&gt;Again: optional, but it will make your life easier.&lt;/p&gt;
&lt;p&gt;Often in academia, I might do an analysis, move on to something else and then have to return that analysis months or years later. I probably will have updated R and some or all of the packages used in that analysis. As a result of these updates, my original code may not work at all or may not do the intended actions. What I need are both the older version of R and the older packages. The package &amp;lsquo;renv&amp;rsquo; is a solution. It captures the versions of R and the loaded packages. It also builds a custom package library for your package (and caches this information across other projects using &lt;code&gt;renv&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Start here:
&lt;em&gt;(you need to aslo be using Rprojects since&lt;/em&gt; &lt;code&gt;renv&lt;/code&gt; &lt;em&gt;is searching for .Rproj file)&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;library(renv)
renv::init()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you have a mature project that&amp;rsquo;s not undergoing any further development at this time, this is all you need to do.&lt;/p&gt;
&lt;p&gt;If you continue to develop your project and install new packages, update your R environment like thus to ensure new or updated packaged are included:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;renv::snapshot()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you&amp;rsquo;re familiar with &lt;strong&gt;Packrat&lt;/strong&gt;, this is a replacement for that. This is particularly helpful for things that may have a long life span, like Shiny apps. The &lt;a href=&#34;https://rstudio.github.io/renv/articles/renv.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;renv package&lt;/a&gt; has extensive documentation worth reading.&lt;/p&gt;
&lt;h3 id=&#34;final-comments&#34;&gt;Final Comments&lt;/h3&gt;
&lt;p&gt;There are many more resources and recommendations for conducting reproducible research in R. There an entire &lt;a href=&#34;https://cran.r-project.org/web/views/ReproducibleResearch.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CRAN task view&lt;/a&gt; devoted to this!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Reproducible Research</title>
      <link>/project/reproducible-research/</link>
      <pubDate>Thu, 15 Apr 2021 00:00:00 +0000</pubDate>
      <guid>/project/reproducible-research/</guid>
      <description>&lt;p&gt;Gosh, reproducible research is important. Let&amp;rsquo;s do more of it!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Routine Incorporation of Spatial Covariates into Analysis of Planned Field Experiments</title>
      <link>/talks/spatial_seminar_20210409/</link>
      <pubDate>Fri, 09 Apr 2021 15:30:00 +0000</pubDate>
      <guid>/talks/spatial_seminar_20210409/</guid>
      <description></description>
    </item>
    
    <item>
      <title>An example preprint / working paper</title>
      <link>/publication/preprint/</link>
      <pubDate>Sun, 07 Apr 2019 00:00:00 +0000</pubDate>
      <guid>/publication/preprint/</guid>
      <description>&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Create your slides in Markdown - click the &lt;em&gt;Slides&lt;/em&gt; button to check out the example.
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Supplementary notes can be added here, including &lt;a href=&#34;https://wowchemy.com/docs/writing-markdown-latex/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;code, math, and images&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>External Project</title>
      <link>/project/external-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0000</pubDate>
      <guid>/project/external-project/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Internal Project</title>
      <link>/project/internal-project/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0000</pubDate>
      <guid>/project/internal-project/</guid>
      <description>&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.&lt;/p&gt;
&lt;p&gt;Nullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.&lt;/p&gt;
&lt;p&gt;Cras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.&lt;/p&gt;
&lt;p&gt;Suspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.&lt;/p&gt;
&lt;p&gt;Aliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>An example journal article</title>
      <link>/publication/journal-article/</link>
      <pubDate>Tue, 01 Sep 2015 00:00:00 +0000</pubDate>
      <guid>/publication/journal-article/</guid>
      <description>&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click the &lt;em&gt;Cite&lt;/em&gt; button above to demo the feature to enable visitors to import publication metadata into their reference management software.
  &lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Create your slides in Markdown - click the &lt;em&gt;Slides&lt;/em&gt; button to check out the example.
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Supplementary notes can be added here, including &lt;a href=&#34;https://wowchemy.com/docs/writing-markdown-latex/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;code, math, and images&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>An example conference paper</title>
      <link>/publication/conference-paper/</link>
      <pubDate>Mon, 01 Jul 2013 00:00:00 +0000</pubDate>
      <guid>/publication/conference-paper/</guid>
      <description>&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click the &lt;em&gt;Cite&lt;/em&gt; button above to demo the feature to enable visitors to import publication metadata into their reference management software.
  &lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Create your slides in Markdown - click the &lt;em&gt;Slides&lt;/em&gt; button to check out the example.
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Supplementary notes can be added here, including &lt;a href=&#34;https://wowchemy.com/docs/writing-markdown-latex/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;code, math, and images&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title></title>
      <link>/admin/config.yml</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/admin/config.yml</guid>
      <description></description>
    </item>
    
    <item>
      <title>Routine incorporation of Spatial Covariates into Analysis of Planned Field Experiments</title>
      <link>/slides/spatial_seminar_20210409/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/slides/spatial_seminar_20210409/</guid>
      <description>&lt;style type=&#34;text/css&#34;&gt;
=

ul {
  color: #282828;
  font-size: 40px;
}

&lt;/style&gt;
&lt;h2 id=&#34;heading&#34;&gt;&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;images/road-auvers-after-rain-6_2840.jpg&#34; alt=&#34;A Road in Auvers After the Rain by Vincent Van Gogh&#34; width=&#34;70%&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;A Road in Auvers After the Rain by Vincent Van Gogh&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;heading-1&#34;&gt;&lt;/h2&gt;
&lt;center&gt; 
### Goal: Make everyone feel more comfortable using spatial stats when analyzing field experimental data. 
&lt;p&gt;(you don&amp;rsquo;t have to be a geospatial statistics expert)&lt;/p&gt;
&lt;/center&gt;
&lt;h2 id=&#34;where-to-find-this-information&#34;&gt;Where to Find This Information&lt;/h2&gt;
&lt;p&gt;This Presentation:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://github.com/IdahoAgStats/lattice-spatial-analysis-talk
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A longer tutorial:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https://idahoagstats.github.io/guide-to-field-trial-spatial-analysis
&lt;/code&gt;&lt;/pre&gt;
&lt;need presentation url&gt;
&lt;h2 id=&#34;what-are-barriers-to-using-spatial-stats&#34;&gt;What Are Barriers to Using Spatial Stats?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Perceived lack of need&lt;/li&gt;
&lt;li&gt;Unsure of benefits&lt;/li&gt;
&lt;li&gt;No training in the topic/intimidated by the statistical methodology&lt;/li&gt;
&lt;li&gt;Limited time to devote to statistical analysis&lt;/li&gt;
&lt;li&gt;Unclear what would happen to blocking if spatial stats are used&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;very few resources for easy implementation&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;spatial-variation-in-agricultural-fields&#34;&gt;Spatial Variation in Agricultural Fields&lt;/h2&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;images/Parker_farm.png&#34; alt=&#34;Univeristy of Idaho&#39;s Parker Farm (Moscow, Idaho)&#34; width=&#34;80%&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;Univeristy of Idaho&#39;s Parker Farm (Moscow, Idaho)&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id=&#34;spatial-variation-in-agricultural-fields-1&#34;&gt;Spatial Variation in Agricultural Fields&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;90%&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;blocking-in-agricultural-fields&#34;&gt;Blocking in Agricultural Fields&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;90%&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;blocking-versus-spatial-analysis&#34;&gt;Blocking versus Spatial Analysis&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;images/boyfriend_meme.jpg&#34; width=&#34;60%&#34; /&gt;&lt;/p&gt;
&lt;p&gt;This is not how this works. Blocking &lt;strong&gt;is&lt;/strong&gt; compatible with spatial analysis and recommended for most (all?) field trials.&lt;/p&gt;
&lt;h2 id=&#34;there-are-many-spatial-methods-available&#34;&gt;There Are Many Spatial Methods Available&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;areal data&lt;/th&gt;
&lt;th&gt;correlated error models&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;row and column trend&lt;/td&gt;
&lt;td&gt;exponential&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;nearest neighbor&lt;/td&gt;
&lt;td&gt;spherical&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;separable ARxAR models&lt;/td&gt;
&lt;td&gt;Gaussian&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;spatial error model&lt;/td&gt;
&lt;td&gt;Matern&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;spatial lag model&lt;/td&gt;
&lt;td&gt;Cauchy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ARIMA&lt;/td&gt;
&lt;td&gt;power&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;splines&lt;/td&gt;
&lt;td&gt;linear&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GAMs&lt;/td&gt;
&lt;td&gt;many more&amp;hellip;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;these-methods-work&#34;&gt;These Methods Work&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;images/gif/spatial_gif.gif&#34; width=&#34;100%&#34; /&gt;&lt;/p&gt;
&lt;h2 class=&#34;columns-2&#34; id=&#34;these-methods-can-be-complex&#34;&gt;These Methods Can Be Complex  &lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;images/ikea.jpg&#34; width=&#34;80%&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&amp;hellip;.But&lt;/p&gt;
&lt;p&gt;You can also integrate spatial methods into gridded field trials without:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;having to know anything about map projections, shapefiles or other geospatial terminology&lt;/li&gt;
&lt;li&gt;possessing a deep understanding of linear modeling techniques or empirical variograms&lt;/li&gt;
&lt;li&gt;being an R or SAS programming expert&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;em&gt;Knowing these things is helpful, but not essential.&lt;/em&gt;&lt;/p&gt;
&lt;h2 id=&#34;a-typical-experiment&#34;&gt;A Typical Experiment&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Experimental treatments&lt;/li&gt;
&lt;li&gt;fully crossed effects&lt;/li&gt;
&lt;li&gt;Blocking scheme along the expected direction of field variation&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-12-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;analysis&#34;&gt;Analysis&lt;/h2&gt;
&lt;h5 id=&#34;a-typical-linear-model&#34;&gt;A typical linear model:&lt;/h5&gt;
&lt;p&gt;$Y_{ij} = \mu + \alpha_i + \beta_j + \epsilon_{ij}$&lt;/p&gt;
&lt;p&gt;Response = trial mean + treatment effect + block effect + leftover error&lt;/p&gt;
&lt;h5 id=&#34;we-assume&#34;&gt;We Assume:&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;The error terms, or residuals, are independent of another with a shared distribution:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;$$\epsilon_i \sim  N(0,\sigma_e)$$&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Each block captures variation unique to that block and there is no other variation related to spatial position of the experimental plots.&lt;/li&gt;
&lt;/ol&gt;
&lt;center&gt; **How often is #2 evaluated?** &lt;/center&gt;
&lt;h2 id=&#34;example-analysis&#34;&gt;Example Analysis&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-13-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;average-yield-by-row-column-and-block&#34;&gt;Average Yield by Row, Column and Block&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-14-1.png&#34; width=&#34;90%&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;standard-analysis-of-kimberly-2013-wheat-variety-trial&#34;&gt;Standard Analysis of Kimberly, 2013 Wheat Variety Trial&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;36 soft white winter wheat cultivars&lt;/li&gt;
&lt;li&gt;4 blocks&lt;/li&gt;
&lt;li&gt;2 missing data points&lt;/li&gt;
&lt;li&gt;the linear model:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;$Y_{ij} = \mu + \alpha_i + \beta_j + \epsilon_{ij}$&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(nlme)
lm1 &amp;lt;- lme(yield ~ cultivar, random = ~ 1|block, data = mydata, na.action = na.exclude)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;what-do-the-residuals-look-like&#34;&gt;What Do The Residuals Look Like?&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(lm1)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-16-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;what-do-the-residuals-look-like-spatially&#34;&gt;What Do The Residuals Look Like Spatially?&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-18-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;what-do-the-residuals-look-like-spatially-1&#34;&gt;What Do The Residuals Look Like Spatially?&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-19-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;global-morans-test-for-spatial-autocorrelation&#34;&gt;Global Moran&amp;rsquo;s Test for Spatial Autocorrelation&lt;/h2&gt;
&lt;p&gt;$H_0$: There is no spatial autocorrelation &lt;br&gt;
$H_a:$  There is spatial autocorrelation!&lt;/p&gt;
&lt;p&gt;This uses a simple weighting matrix that weights all neighbors that share a plot border (the chess-based &amp;ldquo;rook&amp;rdquo; formation) equally.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;## 
## 	Monte-Carlo simulation of Moran I
## 
## data:  mydata$residuals 
## weights: weights 
## omitted: 88, 97 
## number of simulations + 1: 1000 
## 
## statistic = 0.15869, observed rank = 997, p-value = 0.003
## alternative hypothesis: greater
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;handling-spatial-autocorrelation-in-areal-data&#34;&gt;Handling Spatial Autocorrelation in Areal Data&lt;/h2&gt;
&lt;p&gt;Areal data = finite region divided into discrete sub-regions (plots) with aggregated outcomes&lt;/p&gt;
&lt;p&gt;Options:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;model row and column trends
&lt;ul&gt;
&lt;li&gt;good for known gradients (hill slope, salinity patterns)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;assume plots close together are more similar than plots far apart. The errors terms can be modelled based on proximity, but there is no trial-wide trend
&lt;ul&gt;
&lt;li&gt;autoregressive models (AR)&lt;/li&gt;
&lt;li&gt;models utilizing &amp;ldquo;gaussian random fields&amp;rdquo; for continuously varying data (e.g. point data)&lt;/li&gt;
&lt;li&gt;Smoothing splines&lt;/li&gt;
&lt;li&gt;nearest neighbor&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;basic-linear-model&#34;&gt;Basic Linear Model&lt;/h2&gt;
&lt;p&gt;$$Y_{ij} = \mu + A_i + \epsilon_{ij}$$
$$\epsilon_i \sim  N(0,\sigma)$$&lt;/p&gt;
&lt;p&gt;If N = 4:&lt;/p&gt;
&lt;p&gt;$$e_i ~\sim N \Bigg( 0,
\left[ {\begin{array}{ccc} \sigma^2 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0\
0 &amp;amp; \sigma^2 &amp;amp; 0 &amp;amp; 0\
0 &amp;amp; 0 &amp;amp; \sigma^2 &amp;amp; 0\&lt;br&gt;
0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \sigma^2
\end{array}  } \right] \Bigg) $$&lt;/p&gt;
&lt;p&gt;The variance-covariance matrix indicates a shared variance and all off-diagonals are zero, that is, the errors are uncorrelated.&lt;/p&gt;
&lt;h2 id=&#34;linear-model-with-autoregressive-ar-errors&#34;&gt;Linear Model with Autoregressive (AR) Errors&lt;/h2&gt;
&lt;p&gt;Same linear model:
$$Y_{ij} = \mu + A_i + \epsilon_{ij}$$&lt;/p&gt;
&lt;p&gt;Different variance structure:&lt;/p&gt;
&lt;p&gt;$$e_i ~\sim N \Bigg( 0,  = \sigma^2
\left[ {\begin{array}{cc} 1 &amp;amp; \rho &amp;amp; \rho^2 &amp;amp; \rho^3 \&lt;br&gt;
\rho &amp;amp; 1 &amp;amp; \rho &amp;amp; \rho^2 \&lt;br&gt;
\rho^2 &amp;amp; \rho &amp;amp; 1 &amp;amp; \rho \&lt;br&gt;
\rho^3 &amp;amp; \rho^2 &amp;amp; \rho &amp;amp; 1 \
\end{array} } \right] \Bigg) $$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$\rho$ is a correlation parameter ranging from -1 to 1 where 0 is no correlation and values approaching 1 indicate spatial correlation.&lt;/li&gt;
&lt;li&gt;The &amp;ldquo;one&amp;rdquo; in AR1 means that only the next most adjacent point is considered. There can be AR2, AR3, &amp;hellip;, ARn models.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 class=&#34;columns-2&#34; id=&#34;the-separable-ar1-x-ar1-model&#34;&gt;The Separable AR1 x AR1 model &lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-21-1.png&#34; width=&#34;90%&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AR1xAR1 assumes correlation in two directions, row and column.&lt;/li&gt;
&lt;li&gt;It estimates $\sigma$, $\rho_{column}$, and $\rho_{row}$&lt;/li&gt;
&lt;li&gt;often a good choice since plot are rectangular and hence autocorrelation will differ by direction (&amp;ldquo;anistropy&amp;rdquo;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;more-notes-on-separable-ar1xar1&#34;&gt;More Notes on Separable AR1xAR1&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;From a statistical standpoint, it&amp;rsquo;s one of the more intuitive models&lt;/li&gt;
&lt;li&gt;The implementation in R is a little shaky
&lt;ul&gt;
&lt;li&gt;several packages, all hard to use and incompatible with other R packages&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;It is implemented in SAS&lt;/li&gt;
&lt;li&gt;Some proprietary software implements this (AsREML), others do not (Agrobase)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;semivariance-and-empirical-variograms&#34;&gt;Semivariance and Empirical Variograms&lt;/h2&gt;
&lt;p&gt;A measure of spatial correlation based on all pairwise correlations in a data set, binned by distance apart:&lt;/p&gt;
&lt;p&gt;$\gamma^2(h) = \frac{1}{2} Var[Z(s+h)-Z(s)]$&lt;br&gt;
$Z(s)$ = observed data at point $s$.&lt;br&gt;
$Z(s)$ = observed data at another point $h$ distance from point $s$.&lt;/p&gt;
&lt;p&gt;For a data set with $N$ observation, there are this many pairwise points:&lt;/p&gt;
&lt;p&gt;$\frac{N(N-1)}{2}$&lt;/p&gt;
&lt;h2 id=&#34;empirical-variogram&#34;&gt;Empirical Variogram&lt;/h2&gt;
&lt;p&gt;This uses semivariance to mathematically relate spatial correlations with distance&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;images/Sadoti2014_spherical.jpg&#34; width=&#34;70%&#34; /&gt;&lt;/p&gt;
&lt;p&gt;range = distance up to which is there is spatial correlation
sill = uncorrelated variance of the variable of interest
nugget = measurement error, or short-distance spatial variance and other unaccounted for variance&lt;/p&gt;
&lt;h2 id=&#34;semivariance--empirical-variograms&#34;&gt;Semivariance &amp;amp; Empirical Variograms&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;There are many difference mathematical models for explaining semivariance:
&lt;ul&gt;
&lt;li&gt;exponential, Gaussian, Matérn, spherical, &amp;hellip;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;It is usually used for kriging, or prediction of a new point through spatial interpolation&lt;/li&gt;
&lt;li&gt;It can also be used in a linear model where local observations are used to predict a data point in addition to treatment effects&lt;/li&gt;
&lt;li&gt;Bonus: R and SAS are really good at this!&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;p&gt;Copy data into new object so we can assign it a new class (and remove missing data):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(gstat); library(sp); library(dplyr)
mydata_sp &amp;lt;- mydata %&amp;gt;% filter(!is.na(yield))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Establish &lt;code&gt;coordinates&lt;/code&gt; for data set to make it an &lt;code&gt;sp&lt;/code&gt; object (&amp;ldquo;spatial points&amp;rdquo;):&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;coordinates(mydata_sp) &amp;lt;- ~ row + range
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Set the maximum distance for looking at pairwise correlations:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;max_dist &amp;lt;- 0.5*max(dist(coordinates(mydata_sp)))
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model-1&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;p&gt;Calculate a sample variogram:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;semivar &amp;lt;- variogram(yield ~ block + cultivar, data = mydata_sp,
                        cutoff = max_dist, width = max_dist/12)
nugget_start &amp;lt;- min(semivar$gamma)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model-2&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;p&gt;The empirical variogram:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(semivar)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-27-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model-3&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;p&gt;Set up models for fitting variograms:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;vgm1 &amp;lt;- vgm(model = &amp;quot;Exp&amp;quot;, nugget = nugget_start) # exponential
vgm2 &amp;lt;- vgm(model = &amp;quot;Sph&amp;quot;, nugget = nugget_start) # spherical
vgm3 &amp;lt;- vgm(model = &amp;quot;Gau&amp;quot;, nugget = nugget_start) # Gaussian
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Fit the variogram models to the data:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;variofit1 &amp;lt;- fit.variogram(semivar, vgm1)
variofit2 &amp;lt;- fit.variogram(semivar, vgm2)
variofit3 &amp;lt;- fit.variogram(semivar, vgm3)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model-4&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;p&gt;Look at the error terms to see which model is the best at minimizing error.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;exponential: 26857.3&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;spherical: 26058.3&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Gaussian: 41861.0&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The spherical model is the best at minimizing error.&lt;/p&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model-5&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;plot(semivar, variofit2, main = &amp;quot;Spherical model&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-31-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model-6&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;p&gt;Extract the nugget and sill information from the spherical variogram:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;nugget &amp;lt;- variofit2$psill[1] 
range &amp;lt;- variofit2$range[2] 
sill &amp;lt;- sum(variofit2$psill) 
nugget.effect &amp;lt;- nugget/sill  # the nugget/sill ratio
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;adding-semivariance-to-a-linear-model-7&#34;&gt;Adding Semivariance to a Linear Model&lt;/h2&gt;
&lt;p&gt;Build a correlation structure in &lt;code&gt;nlme&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;cor.sph &amp;lt;- corSpatial(value = c(range, nugget.effect), 
                  form = ~ row + range, 
                  nugget = T, fixed = F,
                  type = &amp;quot;spherical&amp;quot;, 
                  metric = &amp;quot;euclidean&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Update the Model:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;lm_sph &amp;lt;- update(lm1, corr = cor.sph)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;compare-models---log-likelihood&#34;&gt;Compare Models - Log likelihood&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;logLik(lm1)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## &#39;log Lik.&#39; -489.0572 (df=38)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;logLik(lm_sph)
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## &#39;log Lik.&#39; -445.4782 (df=40)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;compare-models---post-hoc-power&#34;&gt;Compare Models - Post-hoc Power&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;anova(lm1)[2,]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##          numDF denDF F-value p-value
## cultivar    35   103  1.6411   0.029
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;anova(lm_sph)[2,]
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##          numDF denDF  F-value p-value
## cultivar    35   103 2.054749  0.0028
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;compare-model-predictions&#34;&gt;Compare Model Predictions&lt;/h2&gt;
&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(emmeans)
lme_preds &amp;lt;- as.data.frame(emmeans(lm1, &amp;quot;cultivar&amp;quot;)) %&amp;gt;% mutate(model = &amp;quot;mixed model&amp;quot;)
sph_preds &amp;lt;- as.data.frame(emmeans(lm_sph, &amp;quot;cultivar&amp;quot;)) %&amp;gt;% 
  mutate(model = &amp;quot;mixed model + spatial&amp;quot;)
preds &amp;lt;- rbind(lme_preds, sph_preds)
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;compare-model-predictions-1&#34;&gt;Compare Model Predictions&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-38-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;p&gt;Highest yielding wheat: &amp;lsquo;Stephens&amp;rsquo; (released in 1977)&lt;/p&gt;
&lt;h2 id=&#34;where-was-stephens-located-in-the-trial&#34;&gt;Where Was Stephens Located in the Trial?&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;main_presentation_files/figure-html/unnamed-chunk-40-1.png&#34; alt=&#34;&#34;&gt;&lt;!-- --&gt;&lt;/p&gt;
&lt;h2 id=&#34;more-notes&#34;&gt;More Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;When models omit blocking, the predictions may be unchanged or they may worsen. This varies by the agronomic field, but in general, blocking a field trial and including block in the statistical model improves your experimental power and controls experimental error.&lt;/li&gt;
&lt;li&gt;There is no single spatial model that fits all&lt;/li&gt;
&lt;li&gt;However, using any spatial model is usually better than none at all&lt;/li&gt;
&lt;li&gt;When you use spatial covariates, your estimates are better and more precise. This really does help you!&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;whats-next&#34;&gt;What&amp;rsquo;s Next:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Track row and range information in your trial data set.&lt;/li&gt;
&lt;li&gt;Look at the tutorial! (we will also add SAS code)&lt;/li&gt;
&lt;li&gt;Try out a few models and see how it impacts your results.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;images/variety testing2.JPG&#34; width=&#34;60%&#34; /&gt;&lt;/p&gt;
&lt;h2 id=&#34;the-seminar-was-brought-to-you-bystatistical-programs&#34;&gt;&lt;em&gt;The Seminar Was Brought to you by&amp;hellip;Statistical Programs!!!&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;Statistical consulting to support the College of Agriculture and Life Sciences.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Bill Price&lt;/strong&gt;, Director, &lt;a href=&#34;mailto:bprice@uidaho.edu&#34;&gt;bprice@uidaho.edu&lt;/a&gt;, AgSci307&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Julia Piaskowski&lt;/strong&gt;, &lt;a href=&#34;mailto:jpiaskowski@uidaho.edu&#34;&gt;jpiaskowski@uidaho.edu&lt;/a&gt;, AgSci 305&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
